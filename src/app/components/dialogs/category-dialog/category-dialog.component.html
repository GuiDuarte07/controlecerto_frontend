@if(data) {
<p-dialog
  [header]="data.newCategory ? 'Criar Categoria' : 'Editar Categoria'"
  [modal]="true"
  [(visible)]="visible"
  [style]="{ width: '40rem' }"
>
  <ng-template pTemplate="body" class="bg-slate-300">
    <form [formGroup]="categoryForm" class="m-4 flex flex-col gap-2">
      <!-- NOVO DA CATEGORIA -->
      <div class="">
        <label for="name" class="label">Nome e Ícone da Categoria</label>
        <!-- ICONE + COR -->
        <div class="flex items-center gap-4">
          <button
            pTooltip="Escolha o ícone e a cor da categoria"
            tooltipPosition="right"
            class="border-none bg-inherit flex justify-center items-center p-2"
            [ngClass]="{
              'rounded-md text-white': selectedIcon === selectedIcon
            }"
            [ngStyle]="{
              'background-color': categoryForm.value.color
            }"
            (click)="iconPanel.toggle($event)"
            type="button"
          >
            <span class="material-symbols-outlined">
              {{ selectedIcon }}
            </span>
          </button>


          <!-- NOME DA CATEGORIA -->
          <input
            pInputText
            class="w-full"
            formControlName="name"
            type="text"
            id="name"
            placeholder="Digite o nome da categoria."
            required
          />

          <p-overlayPanel
            #iconPanel
            styleClass=""
            [showCloseIcon]="true"
            appendTo="body"
          >
            <p-tabView styleClass="w-96 h-60 overflow-y-scroll">
              <!-- SELEÇÃO DE ÍCONE -->
              <p-tabPanel header="Ícone">
                <ul class="p-0 m-0 mt-2 flex flex-wrap justify-start w-full">
                  @for (icon of icons; track icon) {
                  <li class="">
                    <button
                      class="border-none bg-inherit flex justify-center items-center p-1"
                      [ngClass]="{
                        'rounded-md bg-slate-900 text-white':
                          icon === selectedIcon
                      }"
                      (click)="changeSelectedIcon(icon)"
                      type="button"
                    >
                      <span class="material-symbols-outlined">
                        {{ icon }}
                      </span>
                    </button>
                  </li>
                  }
                </ul>
              </p-tabPanel>

              <!-- SELEÇÃO DE COR -->
              <p-tabPanel header="Cor">
                <div class="w-full flex items-center">
                  <p>Outra cor</p>
                  <p-colorPicker
                    formControlName="color"
                    appendTo="body"
                    styleClass="border-none size-8 rounded flex justify-center items-center mx-2 my-1"
                  ></p-colorPicker>
                </div>
                <ul class="p-0 m-0 mt-2 flex flex-wrap justify-start w-full">
                  @for (color of defaultColors; track color) {
                  <li class="">
                    <button
                      [style.background-color]="color"
                      class="border-none size-8 rounded flex justify-center items-center mx-2 my-1"
                      [ngClass]="{
                        'border-[1px] border-slate-300 !border-solid':
                          categoryForm.value.color === color
                      }"
                      (click)="setDefaultColor(color)"
                      type="button"
                    >
                      @if(categoryForm.value.color === color) {
                      <span class="material-symbols-outlined"> check </span>
                      }
                    </button>
                  </li>
                  }
                </ul>
              </p-tabPanel>
            </p-tabView>
          </p-overlayPanel>
        </div>
      </div>

      <!-- TIPO DA CATEGORIA (APENAS PARA CRIAÇÃO) -->
      @if(data.newCategory) {
      <div class="">
        <p class="label">Tipo da Categoria</p>
        <div class="flex w-full gap-2">
          <p-selectButton
            [options]="categoriesTypeOptions"
            formControlName="billType"
            optionLabel="label"
            optionValue="value"
          />
        </div>
      </div>
      }
    </form>
  </ng-template>

  <ng-template pTemplate="footer">
    <button
      pButton
      label="Fechar"
      icon="pi pi-times"
      size="small"
      severity="danger"
      (click)="closeDialog(false)"
    ></button>
    <button
      pButton
      [label]="data.newCategory ? 'Criar' : 'Editar'"
      icon="pi pi-check"
      size="small"
      severity="primary"
      (click)="createNewCategory()"
      [disabled]="!categoryForm.valid"
    ></button>
  </ng-template>
</p-dialog>

}
